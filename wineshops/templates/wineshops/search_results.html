{% extends "wineshops/base_wineshops.html" %}
{% load staticfiles %}

{% block extrastyle %}
    <link rel="stylesheet" href="{% static 'wineshops/searchbox.css' %}"/>
    <link rel="stylesheet" href="{% static 'wineshops/result.css' %}"/>
{% endblock %}

{% block script %}
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true"></script>
    <script type="text/javascript" src="{% static 'wineshops/js/search-box.js' %}"></script>
{% endblock %}


{% block content %}

    <div id="tfheader">
        <form id="tftopsearch" onsubmit="return mainSearch();" method="get" action="{% url 'wineshops:search' %}">
            <input type="text" id="tfq1b" class="tftextinput1" name="q" size="32" maxlength="120"
                   value="{{ query_what }}">
            <input type="text" id="tfq2b" class="tftextinput2" name="o" size="32" maxlength="120"
                   value="{{ query_where }}">
            <input type="hidden" id="id_latitude" name="lat">
            <input type="hidden" id="id_longitude" name="lng">
            <input type="submit" value=">" class="tfbutton2">
        </form>
        <div class="tfclear"></div>
    </div>

    <div class="results">
        <table id="result_list">
            <thead>
            <tr>
                <th scope="col">Magasin</th>
                <th scope="col">Adresse</th>
                <th scope="col">Ville</th>
                <th scope="col">Distance</th>
                <th scope="col">Nb. de référence(s)</th>
                <th scope="col">Prix min.</th>
                <th scope="col">Prix max.</th>
            </tr>
            </thead>
            <tbody>
            {% for shop in results %}
                <tr>
                    <td>{{ shop.shop.name }}</td>
                    <td>{{ shop.shop.address }}</td>
                    <td>{{ shop.shop.zip_code }} {{ shop.shop.city }}</td>
                    <td>{{ shop.dist }} km</td>
                    <td>{{ shop.nb }}</td>
                    <td>{{ shop.price.price_min__min|floatformat:2|default_if_none:""  }}</td>
                    <td>{{ shop.price.price_max__max|floatformat:2|default_if_none:""  }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}